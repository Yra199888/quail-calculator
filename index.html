<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quail Calculator ‚Äî PRO MODE</title>

    <!-- PWA -->
    <link rel="manifest" href="manifest.webmanifest">

    <!-- –ú—ñ—Å—Ü–µ –¥–ª—è —Å—Ç–∏–ª—ñ–≤ Material 3 -->
    <link rel="stylesheet" href="material.css">

    <style>
        #probar {
            background: #2d6a1f;
            color: white;
            padding: 12px;
            text-align: center;
            font-size: 16px;
        }

        #probar button {
            margin: 4px;
            padding: 10px 16px;
            background: #D4F2A1;
            color: #0D2601;
            border-radius: 10px;
            border: none;
            font-weight: 600;
        }

        #statusBar {
            font-weight: bold;
            margin-top: 6px;
        }
    </style>
</head>

<body>

<!-- üî• PRO MODE BAR ‚Äî –¥–æ–¥–∞–Ω–æ -->
<div id="probar">
    <div>üî• <b>PRO MODE –∞–∫—Ç–∏–≤–Ω–∏–π</b></div>
    <div id="statusBar">–°—Ç–∞—Ç—É—Å: offline</div>

    <button id="saveLocal">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ</button>
    <button id="backupDrive">‚òÅ –†–µ–∑–µ—Ä–≤–Ω–∞ –∫–æ–ø—ñ—è Drive</button>
    <button id="restoreDrive">üîÑ –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ —ñ–∑ Drive</button>
</div>

<!-- üü© –¢–í–û–Ø –°–¢–ê–†–ê –ù–ê–í–Ü–ì–ê–¶–Ü–Ø + –í–°–Ü –°–ï–ö–¶–Ü–á -->
<div class="m3-tabs">
  <div class="m3-tab active" onclick="showPage('feed')">–ö–æ—Ä–º</div>
  <div class="m3-tab" onclick="showPage('eggs')">–Ø–π—Ü—è</div>
  <div class="m3-tab" onclick="showPage('orders')">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</div>
  <div class="m3-tab" onclick="showPage('clients')">–ö–ª—ñ—î–Ω—Ç–∏</div>
  <div class="m3-tab" onclick="showPage('finance')">–§—ñ–Ω–∞–Ω—Å–∏</div>
  <div class="m3-tab" onclick="showPage('incub')">–Ü–Ω–∫—É–±–∞—Ü—ñ—è</div>
</div>

<div id="feed" class="section-page" style="display:block;">

  <!-- 1. –ö–æ–º–±—ñ–∫–æ—Ä–º -->
  <div class="m3-card">
      <h2>1. –ö–æ–º–±—ñ–∫–æ—Ä–º</h2>

      <label>–ë–∞–∂–∞–Ω–∞ –≤–∞–≥–∞ –ø–∞—Ä—Ç—ñ—ó (–∫–≥)</label>
      <input type="number" id="targetKg" value="25" onchange="recalcFeed()">

      <div style="margin-bottom:12px;">
          <button onclick="applyRecipePreset('starter')">–°—Ç–∞—Ä—Ç–µ—Ä</button>
          <button onclick="applyRecipePreset('grower')">–ì—Ä–æ–≤–µ—Ä</button>
          <button onclick="applyRecipePreset('layer')">–ù–µ—Å—É—á–∫–∏</button>
      </div>

      <table class="m3-table">
          <thead>
              <tr><th>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç</th><th>–ö-—Å—Ç—å –∫–≥</th><th>–¶—ñ–Ω–∞</th><th>–°—É–º–∞</th></tr>
          </thead>
          <tbody id="feedRows"></tbody>
      </table>

      <p><b>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞–≥–∞:</b> <span id="feedTotalKg">0</span> –∫–≥</p>
      <p><b>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å:</b> <span id="feedTotalCost">0</span> –≥—Ä–Ω</p>
  </div>


    <!-- 3.1. –î–æ–±–æ–≤–∞ –Ω–æ—Ä–º–∞ -->
  <div class="m3-card">
      <section id="dailyFeedSection">
    <h2>3.2. –î–æ–±–æ–≤–∞ –Ω–æ—Ä–º–∞</h2>

    <label>–î–æ–±–æ–≤–∞ –Ω–æ—Ä–º–∞ –Ω–∞ 1 –ø—Ç–∏—Ü—é (–≥):</label>
    <input id="dailyNormInput" type="number" value="30">

    <label>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ç–∞—Ö—ñ–≤:</label>
    <input id="birdCountInput" type="number" value="0">

    <p>–î–æ–±–æ–≤–∞ –ø–æ—Ç—Ä–µ–±–∞: <span id="dailyNeedKg">0</span> –∫–≥</p>
    <p>–í–∞—Ä—Ç—ñ—Å—Ç—å: <span id="dailyCost">0.00</span> –≥—Ä–Ω</p>
</section>
  </div>


  <!-- 3.3. –ó–∞–ø–∞—Å–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ -->
  <div class="m3-card">
     <section id="componentStockSection">
    <h2>3.3. –ó–∞–ø–∞—Å–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤</h2>

    <table id="componentStockTable">
        <tr>
            <th>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç</th>
            <th>–Ñ (–∫–≥)</th>
            <th>–ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–∫—É–ø–∏—Ç–∏ (–∫–≥)</th>
        </tr>
    </table>
</section>
  </div>


  <!-- 3.4. –°–∫–ª–∞–¥ –≥–æ—Ç–æ–≤–æ–≥–æ –∫–æ—Ä–º—É -->
  <div class="m3-card">
     <section id="readyFeedSection">
    <h2>3.4. –ì–æ—Ç–æ–≤–∏–π –∫–æ–º–±—ñ–∫–æ—Ä–º</h2>

    <p>–ì–æ—Ç–æ–≤–æ–≥–æ –∫–æ–º–±—ñ–∫–æ—Ä–º—É: <span id="readyFeed">0</span> –∫–≥</p>

    <label>–í–∞–≥–∞ –ø–∞—Ä—Ç—ñ—ó:</label>
    <input id="batchSizeInput" type="number" value="25">

    <button id="makeFeedBtn">–í–∏–≥–æ—Ç–æ–≤–∏—Ç–∏ –ø–∞—Ä—Ç—ñ—é</button>
    <button id="consumeDailyBtn">–°–ø–∏—Å–∞—Ç–∏ –¥–æ–±–æ–≤—É –Ω–æ—Ä–º—É</button>

    <p>–ó–∞–ª–∏—à–æ–∫: <span id="feedLeft">0</span> –∫–≥</p>
    <p>–•–≤–∞—Ç–∏—Ç—å –Ω–∞ –¥–Ω—ñ–≤: <span id="daysLeft">0</span></p>
</section>
  </div>


  <!-- 3.5. –ú–µ–Ω—ñ —Ç—Ä–µ–±–∞ –∫—É–ø–∏—Ç–∏ -->
  <div class="m3-card">
      <h2>3.5. –ú–µ–Ω—ñ —Ç—Ä–µ–±–∞ –∫—É–ø–∏—Ç–∏</h2>
      <ul id="buySummary"></ul>
  </div>

</div>

<div id="eggs" class="section-page" style="display:none;">

<div class="m3-card">
  <h2>2. –û–±–ª—ñ–∫ —è—î—Ü—å</h2>

  <p>–ó—ñ–±—Ä–∞–Ω–æ: <input id="eggsTotal" type="number" oninput="recalcEggsBalance(); recalcProductivity();"></p>
  <p>–ë—Ä–∞–∫: <input id="eggsBad" type="number" oninput="recalcEggsBalance(); recalcProductivity();"></p>
  <p>–í–ª–∞—Å–Ω—ñ –ø–æ—Ç—Ä–µ–±–∏: <input id="eggsOwn" type="number" oninput="recalcEggsBalance();"></p>
  <p>–ó–∞–ª–∏—à–æ–∫ –∑ —É—á–æ—Ä–∞: <input id="eggsCarry" type="number" oninput="recalcEggsBalance();"></p>

  <table class="m3-table">
      <tr><td>–î–ª—è –ø—Ä–æ–¥–∞–∂—É —Å—å–æ–≥–æ–¥–Ω—ñ</td><td><span id="eggsForSale">0</span></td></tr>
      <tr><td>–ó–∞–≥–∞–ª—å–Ω–∏–π –∑–∞–ª–∏—à–æ–∫</td><td><span id="eggsForSaleTotal">0</span></td></tr>
      <tr><td>–õ–æ—Ç–∫—ñ–≤</td><td><span id="traysCount">0</span></td></tr>
      <tr><td>–ó–∞–ª–∏—à–æ–∫ —è—î—Ü—å</td><td><span id="eggsRemainder">0</span></td></tr>
      <tr><td>–¶—ñ–Ω–∞ –ª–æ—Ç–∫–∞</td><td><input id="trayPrice" type="number" oninput="recalcEggsBalance();"></td></tr>
      <tr><td>–°—É–º–∞</td><td><span id="income">0</span></td></tr>
  </table>

  <h3>2.2. –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</h3>
  –°–∞–º–æ–∫ 1-–∞ –ø–∞—Ä—Ç—ñ—è: <input id="hens1" type="number" oninput="recalcProductivity();">
  –°–∞–º–æ–∫ 2-–∞ –ø–∞—Ä—Ç—ñ—è: <input id="hens2" type="number" oninput="recalcProductivity();">

  <table class="m3-table">
      <tr><td>–í—Å—å–æ–≥–æ —Å–∞–º–æ–∫</td><td><span id="hensTotal">0</span></td></tr>
      <tr><td>–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å %</td><td><span id="productivityToday">0</span></td></tr>
  </table>
</div>

<!-- 2.3 –ü—ñ–¥—Å—É–º–æ–∫ -->
<div class="m3-card">
  <h3>2.3 –ü—ñ–¥—Å—É–º–æ–∫ –ø–æ –ª–æ—Ç–∫–∞—Ö</h3>
  <table class="m3-table">
      <tr><td>–£—Å—å–æ–≥–æ –ª–æ—Ç–∫—ñ–≤</td><td><span id="totalTraysTodayLabel">0</span></td></tr>
      <tr><td>–ó–∞–±—Ä–æ–Ω—å–æ–≤–∞–Ω–æ</td><td><span id="reservedTrays">0</span></td></tr>
      <tr><td>–í—ñ–ª—å–Ω—ñ</td><td><span id="freeTrays">0</span></td></tr>
  </table>
</div>

</div>

<div id="orders" class="section-page" style="display:none;">

<div class="m3-card">
  <h2>5. –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>

  <label>–ö–ª—ñ—î–Ω—Ç</label><input id="ordName">
  <label>–Ø—î—Ü—å</label><input id="ordEggs" type="number">
  <label>–õ–æ—Ç–∫—ñ–≤</label><input id="ordTrays" type="number">
  <label>–î–∞—Ç–∞</label><input id="ordDate" type="date">
  <label>–ü—Ä–∏–º—ñ—Ç–∫–∞</label><input id="ordNote">

  <button onclick="addOrder()">–î–æ–¥–∞—Ç–∏</button>

  <h3>–ê–∫—Ç–∏–≤–Ω—ñ</h3>
  <table class="m3-table"><tbody id="ordersActive"></tbody></table>

  <h3>–í–∏–∫–æ–Ω–∞–Ω—ñ</h3>
  <table class="m3-table"><tbody id="ordersDone"></tbody></table>
</div>

</div>

<div id="clients" class="section-page" style="display:none;">

<div class="m3-card">
  <h2>12. –ö–ª—ñ—î–Ω—Ç–∏</h2>

  <table class="m3-table">
      <thead>
          <tr>
              <th>–ö–ª—ñ—î–Ω—Ç</th>
              <th>–ó–∞–º–æ–≤–ª–µ–Ω—å</th>
              <th>–õ–æ—Ç–∫—ñ–≤</th>
              <th>–Ø—î—Ü—å</th>
              <th>–°—É–º–∞</th>
              <th>–û—Å—Ç–∞–Ω–Ω—î</th>
          </tr>
      </thead>
      <tbody id="clientsBody"></tbody>
  </table>
</div>

</div>

<div id="finance" class="section-page" style="display:none;">

<div class="m3-card">
  <h2>9.1 –ü—ñ–¥—Å—É–º–æ–∫ –¥–Ω—è</h2>
  <table class="m3-table">
      <tr><td>–ö–æ—Ä–º</td><td><span id="summaryFeedCost">0</span></td></tr>
      <tr><td>–í–∏—Ä—É—á–∫–∞</td><td><span id="summaryEggIncome">0</span></td></tr>
      <tr><td>–ü—Ä–∏–±—É—Ç–æ–∫</td><td><span id="summaryProfit">0</span></td></tr>
  </table>

  <h2>9.2 –ó–≤—ñ—Ç –∑–∞ –ø–µ—Ä—ñ–æ–¥</h2>
  <select id="reportPeriod" onchange="recalcReport()">
      <option value="7">7 –¥–Ω—ñ–≤</option>
      <option value="30" selected>30 –¥–Ω—ñ–≤</option>
      <option value="all">–í–µ—Å—å —á–∞—Å</option>
  </select>

  <p>
    –Ü–Ω—à—ñ –≤–∏—Ç—Ä–∞—Ç–∏: 
    <input id="otherCostsMonthly" type="number" oninput="recalcReport()">
  </p>

  <table class="m3-table">
      <tr><td>–î–Ω—ñ–≤</td><td><span id="repDays">0</span></td></tr>
      <tr><td>–Ø—î—Ü—å</td><td><span id="repEggs">0</span></td></tr>
      <tr><td>–õ–æ—Ç–∫—ñ–≤</td><td><span id="repTrays">0</span></td></tr>
      <tr><td>–í–∏—Ä—É—á–∫–∞</td><td><span id="repIncome">0</span></td></tr>
      <tr><td>–í–∏—Ç—Ä–∞—Ç–∏</td><td><span id="repFeedCost">0</span></td></tr>
      <tr><td>–ü—Ä–∏–±—É—Ç–æ–∫</td><td><span id="repProfit">0</span></td></tr>
  </table>
</div>

</div>

<div id="incub" class="section-page" style="display:none;">

<div class="m3-card">
  <h2>6. –Ü–Ω–∫—É–±–∞—Ü—ñ—è</h2>

  <h3>6.1 –ù–æ–≤–∞ –ø–∞—Ä—Ç—ñ—è</h3>
  <p>–ù–∞–∑–≤–∞: <input id="incBatchName"></p>
  <p>–î–∞—Ç–∞ –∑–∞–∫–ª–∞–¥–∫–∏: <input id="incStartDate" type="date"></p>
  <p>–ö—ñ–ª—å–∫—ñ—Å—Ç—å —è—î—Ü—å: <input id="incEggsSet" type="number"></p>
  <p>–ù–æ—Ç–∞—Ç–∫–∞: <textarea id="incNote"></textarea></p>
  <button id="addIncubation">–î–æ–¥–∞—Ç–∏</button>

  <h3>6.2 –§—ñ–ª—å—Ç—Ä</h3>
  <select id="incFilter" onchange="renderInc()">
      <option value="all">–í—Å—ñ</option>
      <option value="active">–ê–∫—Ç–∏–≤–Ω—ñ</option>
      <option value="done">–ó–∞–≤–µ—Ä—à–µ–Ω—ñ</option>
      <option value="candling">–û–≤–æ—Å–∫–æ–ø—ñ—è</option>
      <option value="hatch">–í–∏–≤–µ–¥–µ–Ω–Ω—è</option>
  </select>

  <h3>6.3 –°–ø–∏—Å–æ–∫ –ø–∞—Ä—Ç—ñ–π</h3>
  <table class="m3-table">
      <thead>
          <tr>
              <th>–ü–∞—Ä—Ç—ñ—è</th>
              <th>–î–∞—Ç–∞</th>
              <th>–î–Ω—ñ–≤</th>
              <th>–ó–∞–∫–ª–∞–¥–µ–Ω–æ</th>
              <th>–ù–µ–∑–∞–ø–ª—ñ–¥–Ω–µ–Ω—ñ</th>
              <th>–í–∏–ª—É–ø–∏–ª–æ—Å—å</th>
              <th>–ü–æ–º–µ—Ä–ª–∏ (—ñ–Ω–∫.)</th>
              <th>–ü–æ–º–µ—Ä–ª–∏ (–±—Ä—É–¥–µ—Ä)</th>
              <th>–ñ–∏–≤—ñ</th>
              <th>–ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è</th>
              <th>–ù–æ—Ç–∞—Ç–∫–∞</th>
              <th></th>
          </tr>
      </thead>
      <tbody id="incubationBody"></tbody>
  </table>
</div>

</div>

<div class="m3-card">
  <h2>7. –ì—Ä–∞—Ñ—ñ–∫–∏</h2>
  <canvas id="chartEggs"></canvas>
  <canvas id="chartIncome"></canvas>
</div>

<div class="m3-card">
  <h2>8. –ü–æ–≥–æ–ª—ñ–≤‚Äô—è</h2>

  –°–∞–º—Ü—ñ–≤: <input id="males" type="number" onchange="recalcFlock()">
  –°–∞–º–æ–∫: <input id="females" type="number" onchange="recalcFlock()">
  –°–º–µ—Ä—Ç–Ω—ñ—Å—Ç—å: <input id="deaths" type="number" onchange="recalcFlock()">
  –°–µ—Ä–µ–¥–Ω—ñ–π –≤—ñ–∫: <input id="avgAge" type="number" onchange="recalcFlock()">

  <p><b>–†–∞–∑–æ–º:</b> <span id="flockTotal">0</span></p>
</div>

<div class="m3-card">
  <h2>10. –û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º (PWA)</h2>

  <ul>
    <li>Android ‚Üí Install App</li>
    <li>iOS ‚Üí –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è ‚Üí Add to Home Screen</li>
  </ul>
</div>

<!-- ======================= -->
<!-- GOOGLE DRIVE FULL PRO MODE -->
<!-- ======================= -->

<div class="m3-card">
    <h2>Google Drive ‚Äî FULL PRO BACKUP MODE</h2>

    <p class="small">
      –î–∞–Ω—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø—Ä–æ–ø–∞–¥—É—Ç—å.<br>
      –í—ñ–¥–Ω–æ–≤–ª—é—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.<br>
      –ü—Ä–∞—Ü—é—î –æ—Ñ–ª–∞–π–Ω.<br>
      –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î—Ç—å—Å—è —É Drive –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ.
    </p>

    <button class="m3-btn" id="btnDriveLogin">–£–≤—ñ–π—Ç–∏ –≤ Google</button>
    <button class="m3-btn" id="btnBackup">–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω—É –∫–æ–ø—ñ—é</button>
    <button class="m3-btn" id="btnRestore">–í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ</button>

    <p id="driveStatus">–°—Ç–∞—Ç—É—Å: –æ—á—ñ–∫—É—î—Ç—å—Å—è‚Ä¶</p>
</div>

<div class="m3-card">
  <h2>12. –õ–æ–∫–∞–ª—å–Ω—ñ –∫–æ–ø—ñ—ó</h2>

  <button onclick="exportLocalBackup()">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>
  <input type="file" id="importBackupFile" onchange="importLocalBackup(event)">
</div>

<!-- GOOGLE SCRIPTS -->
<script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
<script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>

<!-- MAIN LOGIC -->
<script src="app.js"></script>
<script src="service-worker.js"></script>

</body>
</html>