<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<title>Quail Farm Tools PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>

/* === –ì–õ–û–ë–ê–õ–¨–ù–Ü –¢–ï–ú–ò === */
:root {
    --bg: #111;
    --text: #fff;
    --card: #1b1b1b;
    --border: #333;
    --accent: #4caf50;
}
.light {
    --bg: #f3f3f3;
    --text: #111;
    --card: #fff;
    --border: #ccc;
    --accent: #2a7cda;
}

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: Arial, sans-serif;
    transition: 0.3s;
}

/* === –ö–ù–û–ü–ö–ê –¢–ï–ú–ò === */
.theme-btn {
    position: fixed;
    top: 12px;
    right: 16px;   /* <<< –¢–£–¢ –í–ò–ü–†–ê–í–õ–ï–ù–û */
    font-size: 30px;
    cursor: pointer;
    z-index: 9999;
}

/* === –¢–ê–ë–õ–ò–¶–Ø –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê === */

table {
    width: 100%;
    border-collapse: collapse;
}

th {
    background: var(--accent);
    color: white;
    padding: 10px 5px;
    font-size: 15px;
}

td {
    border: 1px solid var(--border);
    padding: 8px 6px;
    font-size: 15px;
}

/* –ö–æ–º–ø–æ–Ω–µ–Ω—Ç */
td:first-child {
    width: 40%;
    font-size: 16px;
}

/* –ß–µ—Ä–≤–æ–Ω–∞ –æ–±–ª–∞—Å—Ç—å ‚Äî –∑–º–µ–Ω—à–µ–Ω–æ */
.qty-cell input,
.price-cell input {
    width: 65px !important;
    font-size: 15px;
    text-align: center;
}

/* –°–∏–Ω—è –æ–±–ª–∞—Å—Ç—å ‚Äî –≤–∏—Ä—ñ–≤–Ω—è–Ω–æ –≤–ø—Ä–∞–≤–æ */
.sum-cell {
    width: 95px !important;
    text-align: right !important;
    padding-right: 14px !important;
    font-weight: bold;
}

/* –Ü–Ω–ø—É—Ç–∏ */
input {
    width: 100%;
    padding: 6px 8px;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: #0005;
    color: var(--text);
    box-sizing: border-box;
}

/* –ë–ª–æ–∫ —Ç–∞–±–ª–∏—Ü—ñ ‚Äî —â–æ–± —ñ–Ω–ø—É—Ç–∏ –ù–ï –≤–∏—Ö–æ–¥–∏–ª–∏ –∑–∞ –º–µ–∂—ñ */
.feed-table td input {
    width: 100%;
    max-width: 80px;   /* <<< –ì–û–õ–û–í–ù–ò–ô –§–Ü–ö–° –î–õ–Ø –ú–û–ë–Ü–õ–û–ö */
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä */
.container {
    background: var(--card);
    padding: 20px;
    border-radius: 10px;
    border: 1px solid var(--border);
    max-width: 900px;
    margin: 20px auto;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
h2 {
    font-size: 26px;
}

/* === –ú–ï–ù–Æ === */
.topnav {
    display: flex;
    justify-content: space-around;
    align-items: center;
    background: var(--card);
    padding: 14px 0;
    border-bottom: 2px solid var(--border);
}

.tab-icon {
    font-size: 26px;
    opacity: 0.6;
    transform: scale(1);
    transition: 0.2s ease;
}

.tab-icon.active {
    opacity: 1;
    transform: scale(1.20);
    color: var(--accent);
}

/* === –í–µ—Ä—Ö–Ω—î –º–µ–Ω—é —ñ–∫–æ–Ω–æ–∫ (tab-icon) === */
.topnav {
    display: flex;
    justify-content: space-around;
    align-items: center;
    background: var(--card);
    padding: 10px 0;
    border-bottom: 2px solid var(--border);
}

/* –±–æ –≤ HTML —É —Ç–µ–±–µ class="tab-icon", –∞ –Ω–µ tab-btn */
.tab-icon {
    flex: 1;
    text-align: center;
    font-size: 24px;
    opacity: 0.6;
    transform: scale(1);
    transition: 0.2s ease;
}
.tab-icon.active {
    opacity: 1;
    transform: scale(1.2);  /* +20% */
    color: var(--accent);
}

/* === –ù–∏–∂–Ω—î –º–µ–Ω—é –ø—ñ–¥ –≤–µ—Ä—Ö–Ω—ñ–º === */
.subnav {
    display: flex;
    justify-content: space-around;
    align-items: center;
    background: var(--card);
    border-bottom: 1px solid var(--border);
    padding: 6px 0 10px;
    gap: 4px;
}

.subnav-icon {
    flex: 1;
    text-align: center;
    font-size: 20px;
    opacity: 0.7;
}

.subnav-icon.theme-icon {
    font-size: 20px;
    cursor: pointer;
}

/* –°—Ç–æ—Ä—ñ–Ω–∫–∏ */
.page {
    display: none;
    padding: 20px;
}
.active-page {
    display: block;
}

/* –ö–Ω–æ–ø–∫–∏ */
button {
    background: var(--accent);
    color: white;
    border: none;
    padding: 10px 16px;
    font-size: 15px;
    border-radius: 6px;
    margin-top: 10px;
}

/* –°—Ç–∞—Ç—É—Å–∏ */
.status-active { color: #4caf50; font-weight: bold; }
.status-completed { color: #2196f3; font-weight: bold; }
.status-cancelled { color: #e53935; font-weight: bold; }

/* –ë–ª–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è */
.order-block {
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 8px;
    background: #0003;
    border: 1px solid var(--border);
}
/* =======================================================
   ===   –°–ö–õ–ê–î (–°–¢–ò–õ–¨ C ‚Äî –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π)               ===
   ======================================================= */

/* –ó–∞–≥–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
.stock-container {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 18px;
    margin: 20px auto;
    max-width: 900px;
}

/* –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π */
.stock-category-title {
    font-size: 19px;
    font-weight: bold;
    margin: 18px 0 10px;
    color: var(--accent);
}

/* –û–¥–Ω–∞ –ø–æ–∑–∏—Ü—ñ—è */
.stock-item {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 8px;
    align-items: center;
    padding: 10px;
    background: #0004;
    border-radius: 8px;
    margin-bottom: 12px;
    border: 1px solid var(--border);
}

/* –ù–∞–∑–≤–∞ –ø—Ä–æ–¥—É–∫—Ç—É */
.stock-item-name {
    font-size: 15px;
    font-weight: bold;
}

/* –ü–æ–ª—è */
.stock-item input {
    width: 90px;
    padding: 6px;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: #0005;
    color: var(--text);
    text-align: center;
}

/* –ü—ñ–¥–ø–∏—Å–∏ */
.stock-item-label {
    font-size: 13px;
    opacity: 0.8;
}

/* –î–≤—ñ –∫–æ–ª–æ–Ω–∫–∏ –∑–Ω–∞—á–µ–Ω—å */
.stock-values {
    display: grid;
    grid-template-columns: repeat(3, auto);
    gap: 10px;
    text-align: center;
}

/* –ö–Ω–æ–ø–∫–∞ —Å–ø–∏—Å–∞–Ω–Ω—è */
.stock-writeoff-btn {
    width: 100%;
    margin-top: 20px;
    padding: 12px;
    font-size: 17px;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä "–ù–æ–≤–µ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è" */
.stock-add-box {
    margin-top: 20px;
    padding: 14px;
    border-radius: 8px;
    background: #0003;
    border: 1px solid var(--border);
}

/* –ö–Ω–æ–ø–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è */
.stock-add-btn {
    background: #2962ff;
    color: #fff;
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    margin-top: 10px;
    cursor: pointer;
}

/* –†–æ–∑–¥—ñ–ª—å–Ω–∞ –ª—ñ–Ω—ñ—è –º—ñ–∂ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏ */
.stock-divider {
    width: 100%;
    height: 1px;
    background: var(--border);
    margin: 25px 0;
}

/* –ú–æ–±—ñ–ª—å–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü—ñ—è */
@media (max-width: 480px) {
    .stock-values {
        grid-template-columns: 1fr 1fr 1fr;
        gap: 6px;
    }
    .stock-item input {
        width: 75px;
        font-size: 14px;
    }
}
</style>
</head>

<body>

<!-- === –ù–ê–í–Ü–ì–ê–¶–Ü–Ø –ó–í–ï–†–•–£ === -->
<div class="topnav">
  <div class="tab-icon active" onclick="openTab('calculator', this)">üßÆ</div>
  <div class="tab-icon" onclick="openTab('eggs', this)">ü•ö</div>
  <div class="tab-icon" onclick="openTab('orders', this)">üì¶</div>
  <div class="tab-icon" onclick="openTab('finance', this)">üí∞</div>
</div>

<!-- === –ù–ò–ñ–ù–Ñ –ú–ï–ù–Æ (–°–∫–ª–∞–¥ / –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è / –∑–∞–ø–∞—Å / –ü–µ—Ä–µ–º–∏–∫–∞—á —Ç–µ–º–∏) === -->
<div class="subnav">
  <div class="subnav-icon" onclick="openWarehouse()" title="–°–∫–ª–∞–¥">üèöÔ∏è</div>
  <div class="subnav-icon" onclick="openSettings()" title="–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è">‚öôÔ∏è</div>
  <div class="subnav-icon" title="–ù–∞ –ø–æ—Ç—ñ–º"></div>
  <div class="subnav-icon theme-icon" id="themeIcon" onclick="toggleTheme()" title="–¢–µ–º–∞">üåô</div>
</div>

<!-- === –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† === -->
<div id="page-calculator" class="page active-page">
  <h2>üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–æ—Ä–º—É</h2>
  <div class="container">
   <table class="feed-table">
    <tr>
        <th>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç</th>
        <th class="feed-col-qty">–ö-—Å—Ç—å</th>
        <th class="feed-col-price">–¶—ñ–Ω–∞</th>
        <th class="feed-col-sum">–°—É–º–∞</th>
    </tr>
</table>

<table id="feedTable" class="feed-table"></table>

    <h3>–û–± º—î–º –∫–æ—Ä–º—É (–∫–≥):</h3>
    <input id="feedVolume" type="number" value="25">

    <p>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: <b id="feedTotal">0</b> –≥—Ä–Ω</p>
    <p>–¶—ñ–Ω–∞ –∑–∞ –∫–≥: <b id="feedPerKg">0</b> –≥—Ä–Ω</p>
    <p>–°—É–º–∞ –∑–∞ –æ–± º—î–º: <b id="feedVolumeTotal">0</b> –≥—Ä–Ω</p>
  </div>
</div>

<!-- === –Ø–ô–¶–Ø === -->
<div id="page-eggs" class="page">
  <h2>ü•ö –û–±–ª—ñ–∫ —è—î—Ü—å</h2>

  <div class="container">
    <label>–î–∞—Ç–∞:</label>
    <input type="date" id="eggsDate">

    <label>–Ø—î—Ü—å –∑–∞ –¥–æ–±—É:</label>
    <input id="eggsGood" type="number">

    <label>–ë—Ä–∞–∫–æ–≤–∞–Ω—ñ:</label>
    <input id="eggsBad" type="number">

    <label>–î–ª—è –¥–æ–º—É:</label>
    <input id="eggsHome" type="number">

    <button onclick="saveEggRecord()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
  </div>

  <h3>–©–æ–¥–µ–Ω–Ω–∏–π –∑–≤—ñ—Ç</h3>
  <div id="eggsList"></div>
</div>

<!-- === –ó–ê–ú–û–í–õ–ï–ù–ù–Ø === -->
<div id="page-orders" class="page">
  <h2>üì¶ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>

  <div class="container">
    <label>–î–∞—Ç–∞:</label>
    <input id="orderDate" type="date">

    <label>–Ü–º'—è –∫–ª—ñ—î–Ω—Ç–∞:</label>
    <input id="orderName">

    <label>–õ–æ—Ç–∫—ñ–≤:</label>
    <input id="orderTrays" type="number">

    <label>–î–µ—Ç–∞–ª—ñ:</label>
    <textarea id="orderDetails"></textarea>

    <button onclick="addOrder()">–î–æ–¥–∞—Ç–∏</button>
  </div>

  <h3>–°–ø–∏—Å–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
  <div id="ordersList"></div>
</div>

<!-- === –§–Ü–ù–ê–ù–°–ò === -->
<div id="page-finance" class="page">
  <h2>üí∞ –§—ñ–Ω–∞–Ω—Å–∏</h2>

  <div class="container">
    <label>–¶—ñ–Ω–∞ –∑–∞ –ª–æ—Ç–æ–∫:</label>
    <input id="trayPrice" type="number" value="50">

    <button onclick="saveFinanceSettings()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>

    <h3>–ó–≤—ñ—Ç</h3>
    <div id="financeReport"></div>

    <button onclick="exportCSV()">–ï–∫—Å–ø–æ—Ä—Ç CSV</button>
  </div>
</div>

<!-- === –°–¢–û–†–Ü–ù–ö–ê 5: –°–ö–õ–ê–î === -->
<div id="page-stock" class="page">
  <h2>üèöÔ∏è –°–∫–ª–∞–¥</h2>

  <!-- –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –≤–∫–ª–∞–¥–∫–∏ —Å–∫–ª–∞–¥—É -->
  <div class="stock-tabs">
      <div class="stock-tab active" onclick="openStockTab('feed')">–ì–æ—Ç–æ–≤–∏–π –∫–æ—Ä–º</div>
      <div class="stock-tab" onclick="openStockTab('grain')">–ó–µ—Ä–Ω–æ</div>
      <div class="stock-tab" onclick="openStockTab('cake')">–ú–∞–∫—É—Ö–∞ / –®—Ä–æ—Ç–∏</div>
      <div class="stock-tab" onclick="openStockTab('minerals')">–ú—ñ–Ω–µ—Ä–∞–ª–∏ / –î–æ–±–∞–≤–∫–∏</div>
      <div class="stock-tab" onclick="openStockTab('pack')">–£–ø–∞–∫–æ–≤–∫–∞</div>
      <div class="stock-tab" onclick="openStockTab('product')">–ì–æ—Ç–æ–≤–∞ –ø—Ä–æ–¥—É–∫—Ü—ñ—è</div>
  </div>

  <!-- === –ë–õ–û–ö–ò –ö–ê–¢–ï–ì–û–†–Ü–ô –°–ö–õ–ê–î–£ === -->

  <!-- –ì–æ—Ç–æ–≤–∏–π –∫–æ—Ä–º -->
  <div id="stock-feed" class="stock-section active-stock">
      <h3>–ì–æ—Ç–æ–≤–∏–π –∫–æ—Ä–º</h3>

      <div class="container stock-box">
          <label>–ó–∞–ª–∏—à–æ–∫ (–∫–≥):</label>
          <input type="number" id="feedLeft" />

          <label>–ù–æ–≤–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–Ω—è (–∫–≥):</label>
          <input type="number" id="feedAdd" />

          <label>–°–ø–∏—Å–∞—Ç–∏ –Ω–∞ –∑–∞–º—ñ—Å (–∫–≥):</label>
          <input type="number" id="feedUse" />

          <button onclick="saveStock('feed')">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      </div>

      <div class="stock-output" id="feedOutput"></div>
  </div>

  <!-- –ó–µ—Ä–Ω–æ -->
  <div id="stock-grain" class="stock-section">
      <h3>–ó–µ—Ä–Ω–æ</h3>

      <div class="container stock-box">
          <label>–ó–∞–ª–∏—à–æ–∫ (–∫–≥):</label>
          <input type="number" id="grainLeft" />

          <label>–ù–æ–≤–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–Ω—è (–∫–≥):</label>
          <input type="number" id="grainAdd" />

          <label>–°–ø–∏—Å–∞—Ç–∏ –Ω–∞ –∑–∞–º—ñ—Å (–∫–≥):</label>
          <input type="number" id="grainUse" />

          <button onclick="saveStock('grain')">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      </div>

      <div class="stock-output" id="grainOutput"></div>
  </div>

  <!-- –ú–∞–∫—É—Ö–∞ / –®—Ä–æ—Ç–∏ -->
  <div id="stock-cake" class="stock-section">
      <h3>–ú–∞–∫—É—Ö–∞ / –®—Ä–æ—Ç–∏</h3>

      <div class="container stock-box">
          <label>–ó–∞–ª–∏—à–æ–∫ (–∫–≥):</label>
          <input type="number" id="cakeLeft" />

          <label>–ù–æ–≤–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–Ω—è (–∫–≥):</label>
          <input type="number" id="cakeAdd" />

          <label>–°–ø–∏—Å–∞—Ç–∏ –Ω–∞ –∑–∞–º—ñ—Å (–∫–≥):</label>
          <input type="number" id="cakeUse" />

          <button onclick="saveStock('cake')">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      </div>

      <div class="stock-output" id="cakeOutput"></div>
  </div>

  <!-- –ú—ñ–Ω–µ—Ä–∞–ª–∏ -->
  <div id="stock-minerals" class="stock-section">
      <h3>–ú—ñ–Ω–µ—Ä–∞–ª–∏ / –î–æ–±–∞–≤–∫–∏</h3>

      <div class="container stock-box">
          <label>–ó–∞–ª–∏—à–æ–∫ (–∫–≥):</label>
          <input type="number" id="mineralsLeft" />

          <label>–ù–æ–≤–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–Ω—è (–∫–≥):</label>
          <input type="number" id="mineralsAdd" />

          <label>–°–ø–∏—Å–∞—Ç–∏ –Ω–∞ –∑–∞–º—ñ—Å (–∫–≥):</label>
          <input type="number" id="mineralsUse" />

          <button onclick="saveStock('minerals')">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      </div>

      <div class="stock-output" id="mineralsOutput"></div>
  </div>

  <!-- –£–ø–∞–∫–æ–≤–∫–∞ ‚Äî —à—Ç—É–∫–∏ -->
  <div id="stock-pack" class="stock-section">
      <h3>–£–ø–∞–∫–æ–≤–∫–∞</h3>

      <div class="container stock-box">
          <label>–ó–∞–ª–∏—à–æ–∫ (—à—Ç):</label>
          <input type="number" id="packLeft" />

          <label>–ù–æ–≤–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–Ω—è (—à—Ç):</label>
          <input type="number" id="packAdd" />

          <label>–°–ø–∏—Å–∞—Ç–∏ (—à—Ç):</label>
          <input type="number" id="packUse" />

          <button onclick="saveStock('pack')">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      </div>

      <div class="stock-output" id="packOutput"></div>
  </div>

  <!-- –ì–æ—Ç–æ–≤–∞ –ø—Ä–æ–¥—É–∫—Ü—ñ—è -->
  <div id="stock-product" class="stock-section">
      <h3>–ì–æ—Ç–æ–≤–∞ –ø—Ä–æ–¥—É–∫—Ü—ñ—è</h3>

      <div class="container stock-box">
          <label>–õ–æ—Ç–∫–∏ (—à—Ç):</label>
          <input type="number" id="prodLeft" />

          <label>–ù–æ–≤–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–Ω—è (—à—Ç):</label>
          <input type="number" id="prodAdd" />

          <label>–°–ø–∏—Å–∞—Ç–∏ / –í–∏–¥–∞—Ç–∏ (—à—Ç):</label>
          <input type="number" id="prodUse" />

          <button onclick="saveStock('product')">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      </div>

      <div class="stock-output" id="productOutput"></div>
  </div>

</div>

<script>
/* === –¢–ï–ú–ê === */
function toggleTheme() {
  document.body.classList.toggle("light");
  const i = document.getElementById("themeIcon");
  i.innerText = document.body.classList.contains("light") ? "‚òÄÔ∏è" : "üåô";
}
toggleTheme();

/* === –í–ö–õ–ê–î–ö–ò === */
function openTab(page, el) {
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active-page"));
  document.querySelector("#page-" + page).classList.add("active-page");

  document.querySelectorAll(".tab-icon").forEach(i=>i.classList.remove("active"));
  el.classList.add("active");
}

/* === –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† === */
const feedComponents = [
  ["–ö—É–∫—É—Ä—É–¥–∑–∞",10],
  ["–ü—à–µ–Ω–∏—Ü—è",5],
  ["–Ø—á–º—ñ–Ω—å",1.5],
  ["–°–æ—î–≤–∞ –º–∞–∫—É—Ö–∞",3],
  ["–°–æ–Ω—è—à–Ω–∏–∫–æ–≤–∞ –º–∞–∫—É—Ö–∞",2.5],
  ["–†–∏–±–Ω–µ –±–æ—Ä–æ—à–Ω–æ",1],
  ["–ö–æ—Ä–º–æ–≤—ñ –¥—Ä—ñ–∂–¥–∂—ñ",0.7],
  ["–¢—Ä–∏–∫–∞–ª—å—Ü—ñ–π—Ñ–æ—Å—Ñ–∞—Ç",0.5],
  ["Dolfos D",0.7],
  ["–°—ñ–ª—å",0.05]
];

function loadFeed() {
  let html="";
  feedComponents.forEach((c,i)=>{
    let p = localStorage.getItem("p"+i) || 0;
    html += `
    <tr>
      <td>${c[0]}</td>
      <td><input id="qty${i}" value="${c[1]}"></td>
      <td><input id="price${i}" value="${p}"></td>
      <td id="sum${i}">0</td>
    </tr>`;
  });
  document.getElementById("feedTable").innerHTML = html;
  calcFeed();
}
loadFeed();

function calcFeed(){
  let total=0,kg=0;
  feedComponents.forEach((c,i)=>{
    let q = +document.getElementById("qty"+i).value;
    let p = +document.getElementById("price"+i).value;
    localStorage.setItem("p"+i,p);
    let s=q*p;
    total+=s; kg+=q;
    document.getElementById("sum"+i).innerText=s.toFixed(2);
  });
  let per=kg?total/kg:0;
  let vol=+document.getElementById("feedVolume").value;
  document.getElementById("feedTotal").innerText=total.toFixed(2);
  document.getElementById("feedPerKg").innerText=per.toFixed(2);
  document.getElementById("feedVolumeTotal").innerText=(per*vol).toFixed(2);
}
document.addEventListener("input", calcFeed);

/* === –Ø–ô–¶–Ø === */
let eggs={};

function saveEggRecord(){
  let d=document.getElementById("eggsDate").value || new Date().toISOString().slice(0,10);
  eggs[d]={
    good:+eggsGood.value||0,
    bad:+eggsBad.value||0,
    home:+eggsHome.value||0
  };
  localStorage.setItem("eggs",JSON.stringify(eggs));
  showEggs();
}
if(localStorage.getItem("eggs")) eggs=JSON.parse(localStorage.getItem("eggs"));

function showEggs(){
  let box="";
  Object.keys(eggs).sort().reverse().forEach(d=>{
    let e=eggs[d];
    let com=e.good-e.bad-e.home;
    let trays=Math.floor(com/20);
    box+=`
    <div class="order-block">
      <b>${d}</b><br>
      –í—Å—å–æ–≥–æ: ${e.good}<br>
      –ë—Ä–∞–∫: ${e.bad}<br>
      –î—ñ–º: ${e.home}<br>
      –ö–æ–º–µ—Ä—Ü—ñ–π–Ω—ñ: ${com}<br>
      –õ–æ—Ç–∫–∏: ${trays}<br>
      <button onclick="deleteEgg('${d}')">–í–∏–¥–∞–ª–∏—Ç–∏</button>
    </div>`;
  });
  document.getElementById("eggsList").innerHTML=box;
}
showEggs();

function deleteEgg(d){
  delete eggs[d];
  localStorage.setItem("eggs",JSON.stringify(eggs));
  showEggs();
}

/* === –ó–ê–ú–û–í–õ–ï–ù–ù–Ø === */
let orders={};

if(localStorage.getItem("orders")) orders=JSON.parse(localStorage.getItem("orders"));

function addOrder(){
  let d=orderDate.value || new Date().toISOString().slice(0,10);
  if(!orders[d]) orders[d]=[];
  orders[d].push({
    name:orderName.value,
    trays:+orderTrays.value,
    details:orderDetails.value,
    status:"active"
  });
  localStorage.setItem("orders",JSON.stringify(orders));
  showOrders();
}

function showOrders(){
  let out="";
  Object.keys(orders).sort().reverse().forEach(d=>{
    out+=`<h3>${d}</h3>`;
    orders[d].forEach((o,i)=>{
      out+=`
      <div class="order-block">
        <b>${o.name}</b> ‚Äî ${o.trays} –ª–æ—Ç.<br>
        –î–µ—Ç–∞–ª—ñ: ${o.details}<br>
        –°—Ç–∞—Ç—É—Å: <span class="status-${o.status}">${o.status}</span><br>
        <button onclick="setStatus('${d}',${i},'completed')">–í–∏–∫–æ–Ω–∞–Ω–æ</button>
        <button onclick="setStatus('${d}',${i},'cancelled')">–°–∫–∞—Å–æ–≤–∞–Ω–æ</button>
        <button onclick="deleteOrder('${d}',${i})">–í–∏–¥–∞–ª–∏—Ç–∏</button>
      </div>`;
    });
  });
  document.getElementById("ordersList").innerHTML=out;
}
showOrders();

function setStatus(d,i,s){
  orders[d][i].status=s;
  localStorage.setItem("orders",JSON.stringify(orders));
  showOrders();
}
function deleteOrder(d,i){
  orders[d].splice(i,1);
  if(orders[d].length===0) delete orders[d];
  localStorage.setItem("orders",JSON.stringify(orders));
  showOrders();
}

/* === –§–Ü–ù–ê–ù–°–ò === */
function saveFinanceSettings(){
  localStorage.setItem("trayPrice",trayPrice.value);
  showFinance();
}
function showFinance(){
  let price=+(localStorage.getItem("trayPrice")||50);
  trayPrice.value=price;
  let income=0;
  Object.keys(orders).forEach(d=>{
    orders[d].forEach(o=>{
      if(o.status==="completed") income += o.trays*price;
    });
  });
  document.getElementById("financeReport").innerHTML=
    `<b>–î–æ—Ö—ñ–¥:</b> ${income} –≥—Ä–Ω`;
}
showFinance();

/* === CSV === */
function exportCSV(){
  let rows=["–î–∞—Ç–∞,–Ü–º º—è,–õ–æ—Ç–∫–∏,–î–µ—Ç–∞–ª—ñ,–°—Ç–∞—Ç—É—Å"];
  Object.keys(orders).forEach(d=>{
    orders[d].forEach(o=>{
      rows.push(`${d},${o.name},${o.trays},${o.details},${o.status}`);
    });
  });

  let csv=rows.join("\n");
  let blob=new Blob([csv],{type:"text/csv"});
  let a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="finance.csv";
  a.click();
}

/* ============================================================
   === –°–ö–õ–ê–î ‚Äî –õ–û–ì–Ü–ö–ê (3/3) ===================================
   ============================================================ */

/*
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å–∫–ª–∞–¥—É:

warehouse = {
  "grain": { name: "–ó–µ—Ä–Ω–æ", unit: "–∫–≥", items: { "–ö—É–∫—É—Ä—É–¥–∑–∞": 120, "–ü—à–µ–Ω–∏—Ü—è": 80 } },
  "cake": { name: "–ú–∞–∫—É—Ö–∞ / —à—Ä–æ—Ç–∏", unit: "–∫–≥", items: { "–°–æ—î–≤–∞ –º–∞–∫—É—Ö–∞": 50 } },
  "minerals": { name: "–ú—ñ–Ω–µ—Ä–∞–ª–∏", unit: "–∫–≥", items: { "Dolfos D": 10 } },
  "packing": { name: "–£–ø–∞–∫–æ–≤–∫–∞", unit: "—à—Ç", items: { "–õ–æ—Ç–∫–∏ 20—à—Ç": 140 } },
  "ready": { name: "–ì–æ—Ç–æ–≤–∞ –ø—Ä–æ–¥—É–∫—Ü—ñ—è", unit: "—à—Ç", items: {} }
};
*/

let warehouse = JSON.parse(localStorage.getItem("warehouse") || "{}");

// –Ø–∫—â–æ –ø–æ—Ä–æ–∂–Ω—ñ–π ‚Äî —Å—Ç–≤–æ—Ä—é—î–º–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
if (Object.keys(warehouse).length === 0) {
    warehouse = {
        grain:    { name: "–ó–µ—Ä–Ω–æ", unit: "–∫–≥", items: {} },
        cake:     { name: "–ú–∞–∫—É—Ö–∞ / —à—Ä–æ—Ç–∏", unit: "–∫–≥", items: {} },
        minerals: { name: "–ú—ñ–Ω–µ—Ä–∞–ª–∏ / –¥–æ–±–∞–≤–∫–∏", unit: "–∫–≥", items: {} },
        packing:  { name: "–£–ø–∞–∫–æ–≤–∫–∞", unit: "—à—Ç", items: {} },
        ready:    { name: "–ì–æ—Ç–æ–≤–∞ –ø—Ä–æ–¥—É–∫—Ü—ñ—è", unit: "—à—Ç", items: {} }
    };
    saveWarehouse();
}

function saveWarehouse() {
    localStorage.setItem("warehouse", JSON.stringify(warehouse));
}

/* ============================================================
   === –í–∏–≤—ñ–¥ —Å–∫–ª–∞–¥—É –Ω–∞ –µ–∫—Ä–∞–Ω ==================================
   ============================================================ */

function renderWarehouse() {
    let box = "";

    for (let key in warehouse) {
        const cat = warehouse[key];

        box += `
            <div class="w-cat">
                <h3>${cat.name} <span class="unit">(${cat.unit})</span></h3>

                <div class="w-items">
                    ${Object.keys(cat.items).length === 0 ? "<i>–ü–æ—Ä–æ–∂–Ω—å–æ</i>" : ""}
        `;

        Object.entries(cat.items).forEach(([item, qty]) => {
            box += `
                <div class="w-row">
                    <div class="w-item-name">${item}</div>
                    <div class="w-item-qty">${qty} ${cat.unit}</div>
                </div>
            `;
        });

        box += `
                </div>

                <!-- –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä—É -->
                <div class="w-add">
                    <input type="text" placeholder="–ù–∞–∑–≤–∞" id="name-${key}">
                    <input type="number" placeholder="–ö-—Å—Ç—å" id="qty-${key}">
                    <button onclick="addToWarehouse('${key}')">–î–æ–¥–∞—Ç–∏</button>
                </div>
            </div>
        `;
    }

    document.getElementById("warehouseList").innerHTML = box;
}

renderWarehouse();

/* ============================================================
   === –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–æ–≤–∞—Ä—É =======================================
   ============================================================ */

function addToWarehouse(catKey) {
    let name = document.getElementById("name-" + catKey).value.trim();
    let qty = Number(document.getElementById("qty-" + catKey).value);

    if (!name || qty <= 0) {
        alert("–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å!");
        return;
    }

    if (!warehouse[catKey].items[name]) warehouse[catKey].items[name] = 0;
    warehouse[catKey].items[name] += qty;

    saveWarehouse();
    renderWarehouse();
}

/* ============================================================
   === –°–ü–ò–°–ê–ù–ù–Ø –ù–ê –ó–ê–ú–Ü–° (–û–ë–©–ê –ö–ù–û–ü–ö–ê) =========================
   ============================================================ */

function subtractForMix(recipe) {
    /*
      recipe = {
        "–ö—É–∫—É—Ä—É–¥–∑–∞": 10,
        "–ü—à–µ–Ω–∏—Ü—è": 5,
        "–°–æ—î–≤–∞ –º–∞–∫—É—Ö–∞": 3,
        ...
      }
    */

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å
    for (let comp in recipe) {
        let need = recipe[comp];
        let found = false;

        for (let cat of Object.values(warehouse)) {
            if (cat.items[comp] !== undefined) {
                if (cat.items[comp] < need) {
                    alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É: ${comp}`);
                    return;
                }
                found = true;
            }
        }

        if (!found) {
            alert(`–ö–æ–º–ø–æ–Ω–µ–Ω—Ç "${comp}" –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –Ω–∞ —Å–∫–ª–∞–¥—ñ!`);
            return;
        }
    }

    // –°–ø–∏—Å—É—î–º–æ
    for (let comp in recipe) {
        let need = recipe[comp];

        for (let cat of Object.values(warehouse)) {
            if (cat.items[comp] !== undefined) {
                cat.items[comp] -= need;
            }
        }
    }

    saveWarehouse();
    renderWarehouse();
    alert("–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å–ø–∏—Å–∞–Ω–æ –Ω–∞ –∑–∞–º—ñ—Å!");
}

/* ============================================================
   === –î–û–î–ê–í–ê–ù–ù–Ø –ì–û–¢–û–í–û–ì–û –ö–û–†–ú–£ ===============================
   ============================================================ */

function addReadyFeed(kg) {
    if (kg <= 0) return;

    if (!warehouse.ready.items["–ì–æ—Ç–æ–≤–∏–π –∫–æ—Ä–º"]) {
        warehouse.ready.items["–ì–æ—Ç–æ–≤–∏–π –∫–æ—Ä–º"] = 0;
    }

    warehouse.ready.items["–ì–æ—Ç–æ–≤–∏–π –∫–æ—Ä–º"] += kg;
    saveWarehouse();
    renderWarehouse();
}

</script>

</body>
</html>